<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ShinePro Dilution Calculator</title>
  <style>
    :root {
      --bg:#0b0f14; --panel:#111722; --muted:#9fb0c3; --text:#e9f0f7;
      --accent:#4cc9f0; --accent2:#80ffdb; --danger:#ff6b6b;
      --ring: 0 0 0 3px rgba(76,201,240,.25);
    }
    [data-theme="light"] {
      --bg:#f8fafc; --panel:#ffffff; --muted:#475569; --text:#111827;
      --accent:#0ea5e9; --accent2:#14b8a6; --danger:#dc2626;
      --ring:0 0 0 3px rgba(14,165,233,.25);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, Segoe UI, Roboto, Helvetica, Arial;
      background: var(--bg);
      color:var(--text); display:flex; align-items:flex-start; justify-content:center; padding:32px;
    }
    .app{width:min(1100px,100%)}

    h1.title{font-size:clamp(26px,3vw,34px); margin:0 0 6px; font-weight:800}
    p.sub{color:var(--muted); margin:0 0 18px}

    .card{background:var(--panel); border:1px solid rgba(0,0,0,.1); border-radius:16px; padding:20px; margin-bottom:16px}
    .btn{cursor:pointer; border:1px solid #2b4d66; border-radius:12px; padding:10px 14px; font-weight:700; background:var(--panel); color:var(--text)}
    .btn:hover{filter:brightness(1.1)}
    .footer{margin-top:12px; display:flex; flex-wrap:wrap; gap:10px; align-items:center}
    .badge{display:inline-flex; align-items:center; gap:6px; background:var(--panel); border:1px dashed #334155; border-radius:999px; padding:6px 12px; color:var(--muted)}

    /* tap friendly */
    input, select, button { min-height: 44px; }
  </style>
</head>
<body>
  <div class="app">
    <header style="margin:0 0 16px 4px">
      <h1 class="title">ShinePro Dilution Calculator</h1>
      <p class="sub">Enter a ratio and either a <strong>water volume</strong> or a <strong>total solution</strong>. The calculator gives exact chemical and water amounts with unit conversions.</p>
      <div class="footer">
        <label class="badge"><input id="simpleToggle" type="checkbox"> Simple mode</label>
        <label class="badge"><input id="themeToggle" type="checkbox"> Light mode</label>
      </div>
    </header>

    <!-- Simple mode card -->
    <div id="simpleCard" class="card" style="display:none">
      <h3>Quick Input</h3>
      <div>
        <label for="ratioQuick">Ratio or %</label>
        <input id="ratioQuick" placeholder="e.g. 1:15 or 9%">
      </div>
      <div>
        <label for="amountQuick">Amount</label>
        <input id="amountQuick" type="number" value="1">
        <select id="amountQuickUnit"><option>L</option><option>mL</option><option>oz</option></select>
      </div>
      <div>
        <label for="basisQuick">I have</label>
        <select id="basisQuick"><option value="water">Water amount</option><option value="total">Total solution</option></select>
      </div>
      <button class="btn" id="calcQuick">Calculate</button>
      <div class="footer">
        <div>Concentrate: <span id="chemQuick">—</span></div>
        <div>Water: <span id="waterQuick">—</span></div>
      </div>
    </div>

    <!-- Advanced mode (kept from your earlier version) -->
    <div class="card">
      <h3>Bottle Size Helper</h3>
      <div>
        <label for="bottle">Bottle Size</label>
        <input id="bottle" type="number" value="1">
        <select id="bottleUnit"><option>L</option><option>mL</option><option>oz</option></select>
      </div>
      <div>
        <button class="btn" id="planBottle">Calculate for Bottle Size</button>
      </div>
      <div>
        <label>Optional: Adjust Water</label>
        <input id="waterOverride" type="number" placeholder="e.g. 0.9">
        <select id="waterOverrideUnit"><option value="same">Same as bottle</option><option>L</option><option>mL</option><option>oz</option></select>
      </div>
      <div class="footer">
        <div>Chemical: <span id="bottleChem">—</span></div>
        <div>Water: <span id="bottleWater">—</span></div>
      </div>
    </div>
  </div>

  <script>
    const Unit = {
      toML(v,u){if(u==='mL')return v;if(u==='L')return v*1000;if(u==='oz')return v*29.57;return v},
      fromML(v,u){if(u==='mL')return v;if(u==='L')return v/1000;if(u==='oz')return v/29.57;return v},
      fmt(v){return Number(v.toFixed(2))}
    };

    const simpleToggle=document.querySelector('#simpleToggle');
    const simpleCard=document.querySelector('#simpleCard');
    const ratioQuick=document.querySelector('#ratioQuick');
    const amountQuick=document.querySelector('#amountQuick');
    const amountQuickUnit=document.querySelector('#amountQuickUnit');
    const basisQuick=document.querySelector('#basisQuick');
    const chemQuick=document.querySelector('#chemQuick');
    const waterQuick=document.querySelector('#waterQuick');
    function parseRatio(txt){if(!txt)return null;txt=txt.trim().toLowerCase();let m=txt.match(/([0-9]+)\\s*%/);if(m){let p=+m[1];return {c:1,w:(100-p)/p};}m=txt.match(/([0-9]+)[:\\/x-]([0-9]+)/);if(m){return {c:+m[1],w:+m[2]};}return null;}
    function computeQuick(){let r=parseRatio(ratioQuick.value);if(!r){chemQuick.textContent='—';waterQuick.textContent='—';return;}let amt=Unit.toML(+amountQuick.value,amountQuickUnit.value);let c=r.c,w=r.w;let fracC=c/(c+w);if(basisQuick.value==='water'){let chem=(c/w)*amt;chemQuick.textContent=Unit.fmt(Unit.fromML(chem,amountQuickUnit.value))+' '+amountQuickUnit.value;waterQuick.textContent=Unit.fmt(+amountQuick.value)+' '+amountQuickUnit.value;}else{let chem=amt*fracC;let water=amt-chem;chemQuick.textContent=Unit.fmt(Unit.fromML(chem,amountQuickUnit.value))+' '+amountQuickUnit.value;waterQuick.textContent=Unit.fmt(Unit.fromML(water,amountQuickUnit.value))+' '+amountQuickUnit.value;}}
    document.querySelector('#calcQuick').addEventListener('click',computeQuick);
    simpleToggle.addEventListener('change',()=>{simpleCard.style.display=simpleToggle.checked?'block':'none';});

    // Bottle planner
    const bottle=document.querySelector('#bottle'),bottleUnit=document.querySelector('#bottleUnit');
    const waterOverride=document.querySelector('#waterOverride'),waterOverrideUnit=document.querySelector('#waterOverrideUnit');
    const bottleChem=document.querySelector('#bottleChem'),bottleWater=document.querySelector('#bottleWater');
    document.querySelector('#planBottle').addEventListener('click',()=>{
      let c=1,w=10; // default ratio
      let fracC=c/(c+w),fracW=w/(c+w);
      let bml=Unit.toML(+bottle.value,bottleUnit.value);
      let recChem=bml*fracC,recWater=bml*fracW;
      let useWater=recWater;
      if(waterOverride.value){useWater=Unit.toML(+waterOverride.value,waterOverrideUnit.value==='same'?bottleUnit.value:waterOverrideUnit.value);}
      let useChem=bml-useWater;
      bottleChem.textContent=Unit.fmt(Unit.fromML(useChem,bottleUnit.value))+' '+bottleUnit.value;
      bottleWater.textContent=Unit.fmt(Unit.fromML(useWater,bottleUnit.value))+' '+bottleUnit.value;
    });

    // Theme toggle
    const themeToggle=document.querySelector('#themeToggle');
    function applyTheme(){document.documentElement.setAttribute('data-theme', themeToggle.checked?'light':'dark');localStorage.setItem('shinepro_theme',themeToggle.checked?'light':'dark');}
    themeToggle.addEventListener('change',applyTheme);
    if(localStorage.getItem('shinepro_theme')==='light'){themeToggle.checked=true;applyTheme();}
  </script>
</body>
</html>
